<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>蜜罐服务管理</title>
    <link rel="stylesheet" href="../lib/layui-v2.5.5/css/layui.css">
    <link rel="stylesheet" href="../lib/font-awesome-4.7.0/css/font-awesome.min.css">
    <style>
        .honeypot-container {
            padding: 20px;
            background: #f8f9fa;
            min-height: 100vh;
        }
        
        .overview-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .overview-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .overview-card:hover {
            transform: translateY(-2px);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 18px;
            color: white;
        }
        
        .card-icon.running { background: #52c41a; }
        .card-icon.stopped { background: #ff4d4f; }
        .card-icon.total { background: #1890ff; }
        .card-icon.templates { background: #722ed1; }
        
        .card-title {
            font-size: 14px;
            color: #666;
            margin: 0;
        }
        
        .card-value {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin: 0;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }
        
        .service-panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .quick-actions {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .panel-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 2px solid #1890ff;
            padding-bottom: 10px;
        }
        
        .service-table {
            width: 100%;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-running {
            background: #f6ffed;
            color: #52c41a;
            border: 1px solid #b7eb8f;
        }
        
        .status-stopped {
            background: #fff2f0;
            color: #ff4d4f;
            border: 1px solid #ffccc7;
        }
        
        .status-error {
            background: #fff7e6;
            color: #fa8c16;
            border: 1px solid #ffd591;
        }
        
        .action-btn {
            margin: 0 2px;
            padding: 4px 8px;
            font-size: 12px;
        }
        
        .deploy-form {
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .template-card {
            border: 2px solid #d9d9d9;
            border-radius: 6px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .template-card:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .template-card.selected {
            border-color: #1890ff;
            background: #e6f7ff;
        }
        
        .template-icon {
            font-size: 24px;
            margin-bottom: 8px;
            color: #1890ff;
        }
        
        .template-name {
            font-size: 12px;
            font-weight: bold;
            color: #333;
        }
        
        .batch-actions {
            margin-bottom: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 6px;
        }
        
        .config-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
        }
        
        .config-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 8px;
            padding: 30px;
            width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .config-tabs {
            margin-bottom: 20px;
        }
        
        .tab-btn {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            background: #f5f5f5;
            cursor: pointer;
            margin-right: 5px;
        }
        
        .tab-btn.active {
            background: #1890ff;
            color: white;
            border-color: #1890ff;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .overview-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .config-content {
                width: 90%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="honeypot-container">
        <!-- 服务概览卡片 -->
        <div class="overview-cards">
            <div class="overview-card">
                <div class="card-header">
                    <div class="card-icon running">
                        <i class="fa fa-play"></i>
                    </div>
                    <div>
                        <p class="card-title">运行中服务</p>
                        <p class="card-value" id="running-count">0</p>
                    </div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="card-header">
                    <div class="card-icon stopped">
                        <i class="fa fa-stop"></i>
                    </div>
                    <div>
                        <p class="card-title">已停止服务</p>
                        <p class="card-value" id="stopped-count">0</p>
                    </div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="card-header">
                    <div class="card-icon total">
                        <i class="fa fa-server"></i>
                    </div>
                    <div>
                        <p class="card-title">总服务数</p>
                        <p class="card-value" id="total-count">0</p>
                    </div>
                </div>
            </div>
            
            <div class="overview-card">
                <div class="card-header">
                    <div class="card-icon templates">
                        <i class="fa fa-puzzle-piece"></i>
                    </div>
                    <div>
                        <p class="card-title">可用模板</p>
                        <p class="card-value" id="template-count">0</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 主要内容区域 -->
        <div class="main-content">
            <!-- 服务列表面板 -->
            <div class="service-panel">
                <div class="panel-title">
                    <i class="fa fa-list"></i> 蜜罐服务列表
                </div>
                
                <!-- 批量操作 -->
                <div class="batch-actions">
                    <button class="layui-btn layui-btn-sm" id="batch-start">
                        <i class="fa fa-play"></i> 批量启动
                    </button>
                    <button class="layui-btn layui-btn-sm layui-btn-warm" id="batch-stop">
                        <i class="fa fa-stop"></i> 批量停止
                    </button>
                    <button class="layui-btn layui-btn-sm layui-btn-danger" id="batch-delete">
                        <i class="fa fa-trash"></i> 批量删除
                    </button>
                    <button class="layui-btn layui-btn-sm layui-btn-normal" id="refresh-list">
                        <i class="fa fa-refresh"></i> 刷新
                    </button>
                </div>
                
                <!-- 服务表格 -->
                <table class="layui-table service-table" lay-filter="serviceTable">
                    <thead>
                        <tr>
                            <th lay-data="{type:'checkbox'}"></th>
                            <th lay-data="{field:'port', width:80}">端口</th>
                            <th lay-data="{field:'type', width:120}">服务类型</th>
                            <th lay-data="{field:'template', width:120}">模板</th>
                            <th lay-data="{field:'status', width:100}">状态</th>
                            <th lay-data="{field:'uptime', width:120}">运行时间</th>
                            <th lay-data="{field:'requests', width:100}">请求数</th>
                            <th lay-data="{field:'actions', width:200, toolbar:'#actionTpl'}">操作</th>
                        </tr>
                    </thead>
                    <tbody id="service-tbody">
                        <!-- 动态生成服务列表 -->
                    </tbody>
                </table>
            </div>
            
            <!-- 快速操作面板 -->
            <div class="quick-actions">
                <div class="panel-title">
                    <i class="fa fa-rocket"></i> 快速部署
                </div>
                
                <!-- 预设模板 -->
                <div class="form-group">
                    <label class="form-label">选择模板</label>
                    <div class="template-grid" id="template-grid">
                        <!-- 动态生成模板卡片 -->
                    </div>
                </div>
                
                <!-- 部署表单 -->
                <div class="deploy-form">
                    <div class="form-group">
                        <label class="form-label">端口</label>
                        <input type="number" class="layui-input" id="deploy-port" placeholder="输入端口号" min="1" max="65535">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">服务名称</label>
                        <input type="text" class="layui-input" id="deploy-name" placeholder="输入服务名称">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">描述</label>
                        <textarea class="layui-textarea" id="deploy-desc" placeholder="输入服务描述"></textarea>
                    </div>
                    
                    <button class="layui-btn layui-btn-fluid" id="deploy-btn">
                        <i class="fa fa-plus"></i> 部署蜜罐
                    </button>
                </div>
                
                <hr style="margin: 20px 0;">
                
                <!-- 系统信息 -->
                <div class="panel-title">
                    <i class="fa fa-info-circle"></i> 系统信息
                </div>
                
                <div style="font-size: 12px; color: #666; line-height: 1.6;">
                    <p><strong>CPU使用率:</strong> <span id="cpu-usage">--</span>%</p>
                    <p><strong>内存使用:</strong> <span id="memory-usage">--</span>%</p>
                    <p><strong>网络连接:</strong> <span id="network-connections">--</span></p>
                    <p><strong>活跃攻击:</strong> <span id="active-attacks">--</span></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 配置面板模态框 -->
    <div class="config-panel" id="config-panel">
        <div class="config-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0;">服务配置</h3>
                <button class="layui-btn layui-btn-sm" id="close-config">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            
            <!-- 配置选项卡 -->
            <div class="config-tabs">
                <button class="tab-btn active" data-tab="basic">基础配置</button>
                <button class="tab-btn" data-tab="advanced">高级配置</button>
                <button class="tab-btn" data-tab="security">安全设置</button>
            </div>
            
            <!-- 基础配置 -->
            <div class="tab-content active" id="basic-tab">
                <div class="form-group">
                    <label class="form-label">服务端口</label>
                    <input type="number" class="layui-input" id="config-port">
                </div>
                <div class="form-group">
                    <label class="form-label">服务名称</label>
                    <input type="text" class="layui-input" id="config-name">
                </div>
                <div class="form-group">
                    <label class="form-label">服务类型</label>
                    <select class="layui-input" id="config-type">
                        <option value="web">Web服务</option>
                        <option value="ssh">SSH服务</option>
                        <option value="ftp">FTP服务</option>
                        <option value="telnet">Telnet服务</option>
                    </select>
                </div>
            </div>
            
            <!-- 高级配置 -->
            <div class="tab-content" id="advanced-tab">
                <div class="form-group">
                    <label class="form-label">响应延迟(ms)</label>
                    <input type="number" class="layui-input" id="config-delay" value="0">
                </div>
                <div class="form-group">
                    <label class="form-label">最大连接数</label>
                    <input type="number" class="layui-input" id="config-max-conn" value="100">
                </div>
                <div class="form-group">
                    <label class="form-label">日志级别</label>
                    <select class="layui-input" id="config-log-level">
                        <option value="debug">Debug</option>
                        <option value="info" selected>Info</option>
                        <option value="warn">Warning</option>
                        <option value="error">Error</option>
                    </select>
                </div>
            </div>
            
            <!-- 安全设置 -->
            <div class="tab-content" id="security-tab">
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="config-ssl"> 启用SSL/TLS
                    </label>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="config-rate-limit"> 启用频率限制
                    </label>
                </div>
                <div class="form-group">
                    <label class="form-label">IP白名单</label>
                    <textarea class="layui-textarea" id="config-whitelist" placeholder="每行一个IP地址"></textarea>
                </div>
            </div>
            
            <!-- 操作按钮 -->
            <div style="text-align: right; margin-top: 20px;">
                <button class="layui-btn layui-btn-primary" id="cancel-config">取消</button>
                <button class="layui-btn" id="save-config">保存配置</button>
            </div>
        </div>
    </div>
    
    <!-- 操作按钮模板 -->
    <script type="text/html" id="actionTpl">
        <button class="layui-btn layui-btn-xs action-btn" lay-event="start" {{# if(d.status === 'running'){ }} style="display:none;" {{# } }}>
            <i class="fa fa-play"></i> 启动
        </button>
        <button class="layui-btn layui-btn-xs layui-btn-warm action-btn" lay-event="stop" {{# if(d.status === 'stopped'){ }} style="display:none;" {{# } }}>
            <i class="fa fa-stop"></i> 停止
        </button>
        <button class="layui-btn layui-btn-xs layui-btn-normal action-btn" lay-event="config">
            <i class="fa fa-cog"></i> 配置
        </button>
        <button class="layui-btn layui-btn-xs layui-btn-danger action-btn" lay-event="delete">
            <i class="fa fa-trash"></i> 删除
        </button>
    </script>
    
    <script src="../lib/layui-v2.5.5/layui.js"></script>
    <script>
        layui.use(['table', 'layer', 'form'], function(){
            var table = layui.table;
            var layer = layui.layer;
            var form = layui.form;
            
            // 模拟数据
            var honeypotServices = [
                {
                    id: 1,
                    port: 8080,
                    type: 'Web服务',
                    template: 'default',
                    status: 'running',
                    uptime: '2天3小时',
                    requests: 1247
                },
                {
                    id: 2,
                    port: 8090,
                    type: 'Web服务', 
                    template: 'admin',
                    status: 'running',
                    uptime: '1天12小时',
                    requests: 856
                },
                {
                    id: 3,
                    port: 65535,
                    type: 'Web服务',
                    template: 'bee',
                    status: 'running',
                    uptime: '5小时30分',
                    requests: 342
                }
            ];
            
            var templates = [
                { name: 'default', icon: 'fa-globe', desc: '默认Web服务' },
                { name: 'admin', icon: 'fa-user-secret', desc: '管理后台' },
                { name: 'bee', icon: 'fa-bug', desc: 'Bee蜜罐' },
                { name: 'ssh', icon: 'fa-terminal', desc: 'SSH服务' },
                { name: 'ftp', icon: 'fa-folder', desc: 'FTP服务' },
                { name: 'custom', icon: 'fa-cogs', desc: '自定义' }
            ];
            
            // 初始化页面
            function init() {
                updateOverviewCards();
                renderServiceTable();
                renderTemplateGrid();
                startSystemMonitoring();
            }
            
            // 更新概览卡片
            function updateOverviewCards() {
                var running = honeypotServices.filter(s => s.status === 'running').length;
                var stopped = honeypotServices.filter(s => s.status === 'stopped').length;
                var total = honeypotServices.length;
                
                document.getElementById('running-count').textContent = running;
                document.getElementById('stopped-count').textContent = stopped;
                document.getElementById('total-count').textContent = total;
                document.getElementById('template-count').textContent = templates.length;
            }
            
            // 渲染服务表格
            function renderServiceTable() {
                var tbody = document.getElementById('service-tbody');
                tbody.innerHTML = '';
                
                honeypotServices.forEach(function(service) {
                    var statusClass = 'status-' + service.status;
                    var statusText = service.status === 'running' ? '运行中' : '已停止';
                    
                    var row = document.createElement('tr');
                    row.innerHTML = `
                        <td><input type="checkbox" name="service" value="${service.id}"></td>
                        <td>${service.port}</td>
                        <td>${service.type}</td>
                        <td>${service.template}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>${service.uptime}</td>
                        <td>${service.requests}</td>
                        <td>
                            <button class="layui-btn layui-btn-xs" onclick="startService(${service.id})" ${service.status === 'running' ? 'style="display:none;"' : ''}>
                                <i class="fa fa-play"></i> 启动
                            </button>
                            <button class="layui-btn layui-btn-xs layui-btn-warm" onclick="stopService(${service.id})" ${service.status === 'stopped' ? 'style="display:none;"' : ''}>
                                <i class="fa fa-stop"></i> 停止
                            </button>
                            <button class="layui-btn layui-btn-xs layui-btn-normal" onclick="configService(${service.id})">
                                <i class="fa fa-cog"></i> 配置
                            </button>
                            <button class="layui-btn layui-btn-xs layui-btn-danger" onclick="deleteService(${service.id})">
                                <i class="fa fa-trash"></i> 删除
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
            
            // 渲染模板网格
            function renderTemplateGrid() {
                var grid = document.getElementById('template-grid');
                grid.innerHTML = '';
                
                templates.forEach(function(template) {
                    var card = document.createElement('div');
                    card.className = 'template-card';
                    card.dataset.template = template.name;
                    card.innerHTML = `
                        <div class="template-icon">
                            <i class="fa ${template.icon}"></i>
                        </div>
                        <div class="template-name">${template.desc}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
                        this.classList.add('selected');
                        document.getElementById('deploy-name').value = template.desc + '服务';
                    });
                    
                    grid.appendChild(card);
                });
            }
            
            // 系统监控
            function startSystemMonitoring() {
                function updateSystemInfo() {
                    // 模拟系统信息
                    document.getElementById('cpu-usage').textContent = (Math.random() * 30 + 10).toFixed(1);
                    document.getElementById('memory-usage').textContent = (Math.random() * 40 + 30).toFixed(1);
                    document.getElementById('network-connections').textContent = Math.floor(Math.random() * 50 + 20);
                    document.getElementById('active-attacks').textContent = Math.floor(Math.random() * 10 + 5);
                }
                
                updateSystemInfo();
                setInterval(updateSystemInfo, 5000);
            }
            
            // 服务操作函数
            window.startService = function(id) {
                layer.load(2);
                setTimeout(function() {
                    var service = honeypotServices.find(s => s.id === id);
                    if (service) {
                        service.status = 'running';
                        service.uptime = '刚刚启动';
                        renderServiceTable();
                        updateOverviewCards();
                        layer.closeAll('loading');
                        layer.msg('服务启动成功', {icon: 1});
                    }
                }, 1000);
            };
            
            window.stopService = function(id) {
                layer.confirm('确定要停止此服务吗？', function(index) {
                    layer.load(2);
                    setTimeout(function() {
                        var service = honeypotServices.find(s => s.id === id);
                        if (service) {
                            service.status = 'stopped';
                            service.uptime = '--';
                            renderServiceTable();
                            updateOverviewCards();
                            layer.closeAll('loading');
                            layer.msg('服务已停止', {icon: 1});
                        }
                    }, 500);
                    layer.close(index);
                });
            };
            
            window.configService = function(id) {
                var service = honeypotServices.find(s => s.id === id);
                if (service) {
                    document.getElementById('config-port').value = service.port;
                    document.getElementById('config-name').value = service.type;
                    document.getElementById('config-type').value = 'web';
                    document.getElementById('config-panel').style.display = 'block';
                }
            };
            
            window.deleteService = function(id) {
                layer.confirm('确定要删除此服务吗？删除后无法恢复！', function(index) {
                    honeypotServices = honeypotServices.filter(s => s.id !== id);
                    renderServiceTable();
                    updateOverviewCards();
                    layer.msg('服务已删除', {icon: 1});
                    layer.close(index);
                });
            };
            
            // 部署新服务
            document.getElementById('deploy-btn').addEventListener('click', function() {
                var port = document.getElementById('deploy-port').value;
                var name = document.getElementById('deploy-name').value;
                var desc = document.getElementById('deploy-desc').value;
                var selectedTemplate = document.querySelector('.template-card.selected');
                
                if (!port || !name) {
                    layer.msg('请填写端口和服务名称', {icon: 2});
                    return;
                }
                
                if (honeypotServices.some(s => s.port == port)) {
                    layer.msg('端口已被占用', {icon: 2});
                    return;
                }
                
                layer.load(2);
                setTimeout(function() {
                    var newService = {
                        id: Date.now(),
                        port: parseInt(port),
                        type: name,
                        template: selectedTemplate ? selectedTemplate.dataset.template : 'custom',
                        status: 'running',
                        uptime: '刚刚启动',
                        requests: 0
                    };
                    
                    honeypotServices.push(newService);
                    renderServiceTable();
                    updateOverviewCards();
                    
                    // 清空表单
                    document.getElementById('deploy-port').value = '';
                    document.getElementById('deploy-name').value = '';
                    document.getElementById('deploy-desc').value = '';
                    document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
                    
                    layer.closeAll('loading');
                    layer.msg('蜜罐部署成功', {icon: 1});
                }, 2000);
            });
            
            // 批量操作
            document.getElementById('batch-start').addEventListener('click', function() {
                var selected = getSelectedServices();
                if (selected.length === 0) {
                    layer.msg('请选择要启动的服务', {icon: 2});
                    return;
                }
                
                layer.load(2);
                setTimeout(function() {
                    selected.forEach(function(id) {
                        var service = honeypotServices.find(s => s.id === id);
                        if (service) {
                            service.status = 'running';
                            service.uptime = '刚刚启动';
                        }
                    });
                    renderServiceTable();
                    updateOverviewCards();
                    layer.closeAll('loading');
                    layer.msg(`成功启动 ${selected.length} 个服务`, {icon: 1});
                }, 1000);
            });
            
            document.getElementById('batch-stop').addEventListener('click', function() {
                var selected = getSelectedServices();
                if (selected.length === 0) {
                    layer.msg('请选择要停止的服务', {icon: 2});
                    return;
                }
                
                layer.confirm(`确定要停止 ${selected.length} 个服务吗？`, function(index) {
                    layer.load(2);
                    setTimeout(function() {
                        selected.forEach(function(id) {
                            var service = honeypotServices.find(s => s.id === id);
                            if (service) {
                                service.status = 'stopped';
                                service.uptime = '--';
                            }
                        });
                        renderServiceTable();
                        updateOverviewCards();
                        layer.closeAll('loading');
                        layer.msg(`成功停止 ${selected.length} 个服务`, {icon: 1});
                    }, 500);
                    layer.close(index);
                });
            });
            
            document.getElementById('batch-delete').addEventListener('click', function() {
                var selected = getSelectedServices();
                if (selected.length === 0) {
                    layer.msg('请选择要删除的服务', {icon: 2});
                    return;
                }
                
                layer.confirm(`确定要删除 ${selected.length} 个服务吗？删除后无法恢复！`, function(index) {
                    honeypotServices = honeypotServices.filter(s => !selected.includes(s.id));
                    renderServiceTable();
                    updateOverviewCards();
                    layer.msg(`成功删除 ${selected.length} 个服务`, {icon: 1});
                    layer.close(index);
                });
            });
            
            document.getElementById('refresh-list').addEventListener('click', function() {
                layer.load(2);
                setTimeout(function() {
                    renderServiceTable();
                    updateOverviewCards();
                    layer.closeAll('loading');
                    layer.msg('刷新完成', {icon: 1});
                }, 500);
            });
            
            // 获取选中的服务
            function getSelectedServices() {
                var checkboxes = document.querySelectorAll('input[name="service"]:checked');
                return Array.from(checkboxes).map(cb => parseInt(cb.value));
            }
            
            // 配置面板事件
            document.getElementById('close-config').addEventListener('click', function() {
                document.getElementById('config-panel').style.display = 'none';
            });
            
            document.getElementById('cancel-config').addEventListener('click', function() {
                document.getElementById('config-panel').style.display = 'none';
            });
            
            document.getElementById('save-config').addEventListener('click', function() {
                layer.msg('配置保存成功', {icon: 1});
                document.getElementById('config-panel').style.display = 'none';
            });
            
            // 选项卡切换
            document.querySelectorAll('.tab-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var tab = this.dataset.tab;
                    
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(tab + '-tab').classList.add('active');
                });
            });
            
            // 初始化
            init();
        });
    </script>
</body>
</html>