2025-09-30 08:01:15.530 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 12012 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:01:15.536 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:01:15.537 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:01:16.987 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:01:17.032 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 37 ms. Found 2 JPA repository interfaces.
2025-09-30 08:01:17.518 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:01:17.528 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:01:17.528 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:01:17.599 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:01:17.599 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2024 ms
2025-09-30 08:01:17.802 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:01:17.874 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:01:17.989 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:01:18.113 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:01:18.168 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:01:18.195 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:01:18.263 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:01:18.267 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:01:18.625 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:01:18.631 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:01:18.908 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:01:18.927 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:01:18.934 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:01:18.934 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:01:18.946 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:01:19.234 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:01:19.238 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:01:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:01:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:01:19.243 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 4.043 seconds (JVM running for 9.846)
2025-09-30 08:01:19.250 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:01:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:01:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:01:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:01:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:01:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:01:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:01:19.252 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:01:19.252 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:00:19(String), 2025-09-30 08:01:19(String)
2025-09-30 08:01:19.252 [pool-3-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:01:28.782 [http-nio-8090-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 08:01:28.782 [http-nio-8090-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 08:01:28.782 [http-nio-8090-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 08:01:28.795 [http-nio-8090-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:01:28.795 [http-nio-8090-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), GET(String), /(String), null, aG9zdDogMTI3LjAuMC4xOjgwOTANCmNvbm5lY3Rpb246IGtlZXAtYWxpdmUNCnNlYy1jaC11YTogIkNocm9taXVtIjt2PSIxNDAiLCAiTm90PUE/QnJhbmQiO3Y9IjI0IiwgIkdvb2dsZSBDaHJvbWUiO3Y9IjE0MCINCnNlYy1jaC11YS1tb2JpbGU6ID8wDQpzZWMtY2gtdWEtcGxhdGZvcm06ICJXaW5kb3dzIg0KdXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0czogMQ0KdXNlci1hZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzE0MC4wLjAuMCBTYWZhcmkvNTM3LjM2DQpzZWMtcHVycG9zZTogcHJlZmV0Y2g7cHJlcmVuZGVyDQpwdXJwb3NlOiBwcmVmZXRjaA0KYWNjZXB0OiB0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjcNCnNlYy1mZXRjaC1zaXRlOiBub25lDQpzZWMtZmV0Y2gtbW9kZTogbmF2aWdhdGUNCnNlYy1mZXRjaC11c2VyOiA/MQ0Kc2VjLWZldGNoLWRlc3Q6IGRvY3VtZW50DQphY2NlcHQtZW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUsIGJyLCB6c3RkDQphY2NlcHQtbGFuZ3VhZ2U6IHpoLUNOLHpoO3E9MC45LGVuO3E9MC44DQo=(String), (String), 2025-09-30 08:01:28(String)
2025-09-30 08:01:28.800 [http-nio-8090-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:01:28.809 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:28.810 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:28.811 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:28.815 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:28.815 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:28.817 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:28.823 [http-nio-8090-exec-1] INFO  n.t.l.controller.NotFoundController - bee
2025-09-30 08:01:34.929 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:34.929 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:34.930 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.001 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.001 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.001 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.001 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.001 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.001 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.037 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.037 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.037 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.048 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.048 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.048 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.096 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.096 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.096 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.096 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.096 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.096 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.197 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.197 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.197 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.212 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.212 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.212 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.212 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.212 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.212 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.273 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.273 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.273 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.273 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.273 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.273 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.296 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.296 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.298 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.320 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.320 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.322 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.357 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.357 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.357 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.357 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.357 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.357 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:35.389 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:35.389 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:35.389 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.283 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.283 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.283 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.287 [http-nio-65535-exec-8] INFO  n.t.loki.controller.AdminController - LoginData22233: loki loki@2333
2025-09-30 08:01:42.287 [http-nio-65535-exec-8] DEBUG n.t.l.m.A.getAdminUserByUsername - ==>  Preparing: SELECT * FROM admin_user WHERE username = ?
2025-09-30 08:01:42.288 [http-nio-65535-exec-8] DEBUG n.t.l.m.A.getAdminUserByUsername - ==> Parameters: loki(String)
2025-09-30 08:01:42.288 [http-nio-65535-exec-8] DEBUG n.t.l.m.A.getAdminUserByUsername - <==      Total: 1
2025-09-30 08:01:42.298 [http-nio-65535-exec-8] INFO  n.t.loki.service.AdminUserService - LoginData22233: 31a4bb231d3a2c453ce234a439c4991a8567e5af1acdf428b4858dca9f784cd4 31a4bb231d3a2c453ce234a439c4991a8567e5af1acdf428b4858dca9f784cd4
2025-09-30 08:01:42.370 [http-nio-65535-exec-8] INFO  n.t.loki.controller.AdminController - Logincookie: javax.servlet.http.Cookie@725ba483 
2025-09-30 08:01:42.454 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.454 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.454 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.455 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.455 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.455 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.505 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.505 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.505 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.505 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.505 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.505 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.505 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.505 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.505 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.620 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.620 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.620 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.620 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.620 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.634 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.634 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.634 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.634 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.645 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.645 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.646 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.700 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.700 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.700 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.741 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.741 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.741 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.802 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.802 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.803 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.848 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.848 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.849 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.854 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.854 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.854 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.856 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.856 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.857 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.858 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.859 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.860 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.862 [http-nio-65535-exec-4] INFO  n.t.l.controller.NotFoundController - default
2025-09-30 08:01:42.866 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.867 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.867 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.896 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.896 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.897 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.943 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.943 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.943 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:42.984 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:42.990 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:42.990 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.063 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.063 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.063 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.068 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.068 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.068 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.068 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.068 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.070 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.070 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.070 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.070 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.071 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.072 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.072 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.078 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.078 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.079 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.081 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.081 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.083 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.093 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.093 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.094 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.094 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.094 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.094 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.094 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.094 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.094 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.099 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.105 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.105 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.105 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.105 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.105 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.105 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:43.105 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:43.105 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:43.105 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:45.069 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:45.070 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:45.070 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:45.082 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:45.082 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:45.083 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:46.347 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:46.347 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:01:46.348 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:46.348 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:01:46.348 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:46.348 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:01:46.351 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:01:46.351 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:01:46.351 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:01:46.352 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:01:46.352 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:01:46.352 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:01:46.353 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:01:46.353 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:01:46.353 [http-nio-65535-exec-2] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:01:19(String), 2025-09-30 08:02:19(String)
2025-09-30 08:02:19.245 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 1
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:03:19.247 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:02:19(String), 2025-09-30 08:03:19(String)
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:04:19.252 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:03:19(String), 2025-09-30 08:04:19(String)
2025-09-30 08:05:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:05:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:05:19.247 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:04:19(String), 2025-09-30 08:05:19(String)
2025-09-30 08:06:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:06:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:06:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:05:19(String), 2025-09-30 08:06:19(String)
2025-09-30 08:06:19.246 [pool-3-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:07:19.252 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:07:19.253 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:07:19.253 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:06:19(String), 2025-09-30 08:07:19(String)
2025-09-30 08:08:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:08:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:08:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:08:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:08:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:08:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:08:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:08:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:08:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:08:19.247 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:08:19.247 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:07:19(String), 2025-09-30 08:08:19(String)
2025-09-30 08:09:19.241 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:09:19.241 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:09:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:09:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:09:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:09:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:09:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:09:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:09:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:09:19.244 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:09:19.244 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:08:19(String), 2025-09-30 08:09:19(String)
2025-09-30 08:10:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:10:19.242 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:10:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:10:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:10:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:10:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:10:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:10:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:10:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:10:19.244 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:10:19.244 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:09:19(String), 2025-09-30 08:10:19(String)
2025-09-30 08:11:19.250 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:11:19.250 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:11:19.250 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:10:19(String), 2025-09-30 08:11:19(String)
2025-09-30 08:11:19.251 [pool-3-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:12:19.241 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:12:19.241 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:12:19.243 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:11:19(String), 2025-09-30 08:12:19(String)
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:13:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:13:19.258 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:13:19.258 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:13:19.258 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:12:19(String), 2025-09-30 08:13:19(String)
2025-09-30 08:14:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:14:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:14:19.244 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:14:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:14:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:14:19.245 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:14:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:14:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:14:19.246 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:14:19.246 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:14:19.247 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:13:19(String), 2025-09-30 08:14:19(String)
2025-09-30 08:15:19.254 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:15:19.254 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:15:19.254 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:15:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:15:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:15:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:15:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:15:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:15:19.256 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:15:19.257 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:15:19.257 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:14:19(String), 2025-09-30 08:15:19(String)
2025-09-30 08:16:19.248 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:16:19.248 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:16:19.249 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:16:19.249 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:16:19.249 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:16:19.249 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:16:19.249 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:16:19.249 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:16:19.250 [pool-3-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:16:19.252 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:16:19.252 [pool-3-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:15:19(String), 2025-09-30 08:16:19(String)
2025-09-30 08:16:19.254 [pool-3-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:16:25.477 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 08:16:25.528 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 08:16:25.528 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 08:16:25.530 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:16:25.533 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 08:16:25.536 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 08:16:43.516 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 25364 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:16:43.517 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:16:43.518 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:16:44.671 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:16:44.712 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 35 ms. Found 2 JPA repository interfaces.
2025-09-30 08:16:45.167 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:16:45.177 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:16:45.177 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:16:45.248 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:16:45.248 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1699 ms
2025-09-30 08:16:45.439 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:16:45.516 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:16:45.567 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:16:45.758 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:16:45.811 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:16:45.842 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:16:45.916 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:16:45.920 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:16:46.347 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:16:46.353 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:16:46.603 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:16:46.617 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:16:46.624 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:16:46.625 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:16:46.637 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:16:46.903 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:16:46.908 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:16:46.912 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:16:46.912 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:16:46.912 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 3.683 seconds (JVM running for 4.627)
2025-09-30 08:16:46.923 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:16:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:16:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:16:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:16:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:16:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:16:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:16:46.926 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:16:46.926 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:15:46(String), 2025-09-30 08:16:46(String)
2025-09-30 08:16:46.926 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:17:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:17:46.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:17:46.926 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:17:46.927 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:16:46(String), 2025-09-30 08:17:46(String)
2025-09-30 08:18:28.203 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 08:18:28.243 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 08:18:28.243 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 08:18:28.244 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:18:28.249 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 08:18:28.251 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 08:18:32.303 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 15412 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:18:32.305 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:18:32.305 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:18:32.714 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:18:32.748 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 28 ms. Found 2 JPA repository interfaces.
2025-09-30 08:18:33.206 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:18:33.214 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:18:33.214 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:18:33.282 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:18:33.282 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 942 ms
2025-09-30 08:18:33.462 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:18:33.539 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:18:33.583 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:18:33.698 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:18:33.747 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:18:33.774 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:18:33.843 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:18:33.848 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:18:34.198 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:18:34.205 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:18:34.446 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:18:34.461 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:18:34.467 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:18:34.467 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:18:34.480 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:18:34.739 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:18:34.744 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:18:34.748 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:18:34.748 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:18:34.809 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.805 seconds (JVM running for 3.611)
2025-09-30 08:18:34.815 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:18:34.815 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:18:34.816 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:18:34.816 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:18:34.816 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:18:34.816 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:18:34.816 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:18:34.817 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:18:34.817 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:17:34(String), 2025-09-30 08:18:34(String)
2025-09-30 08:18:34.817 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:18:41.121 [http-nio-8090-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 08:18:41.122 [http-nio-8090-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 08:18:41.122 [http-nio-8090-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 08:18:41.191 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:18:41.191 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:18:41.192 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:18:41.198 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:18:41.198 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:18:41.198 [http-nio-8090-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:18:41.205 [http-nio-8090-exec-1] INFO  n.t.l.controller.NotFoundController - bee
2025-09-30 08:18:51.520 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:18:51.520 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:18:51.521 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:18:51.543 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:18:51.543 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:18:51.543 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:18:51.629 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:18:51.631 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:18:51(String)
2025-09-30 08:18:51.637 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:18:51.637 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:18:51.637 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:51.644 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:18:51.644 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:18:51.644 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:51.646 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:18:52.272 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:18:52.273 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:18:52.273 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:18:52.276 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:18:52.277 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:18:52(String)
2025-09-30 08:18:52.283 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:18:52.284 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:18:52.284 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:52.291 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:18:52.292 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:18:52.292 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:52.292 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:18:53.024 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:18:53.025 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:18:53.025 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:18:53.028 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:18:53.030 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:18:53(String)
2025-09-30 08:18:53.099 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:18:53.100 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:18:53.100 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:53.107 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:18:53.107 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:18:53.107 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:53.107 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:18:53.822 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:18:53.822 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:18:53.823 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:18:53.825 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:18:53.825 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:18:53(String)
2025-09-30 08:18:53.835 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:18:53.836 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:18:53.836 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:53.843 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:18:53.844 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:18:53.844 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:18:53.844 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:19:34.756 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:19:34.756 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:19:34.757 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:19:34.759 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:19:34.759 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:19:34.759 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:19:34.759 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:19:34.759 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:19:34.759 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:19:34.760 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:19:34.760 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:18:34(String), 2025-09-30 08:19:34(String)
2025-09-30 08:19:34.760 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 4
2025-09-30 08:20:20.349 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 08:20:20.390 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 08:20:20.390 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 08:20:20.392 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:20:20.393 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 08:20:20.397 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 08:20:23.694 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 21616 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:20:23.695 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:20:23.696 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:20:24.096 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:20:24.129 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 26 ms. Found 2 JPA repository interfaces.
2025-09-30 08:20:24.530 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:20:24.537 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:20:24.537 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:20:24.592 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:20:24.592 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 866 ms
2025-09-30 08:20:24.731 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:20:24.800 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:20:24.827 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:20:24.918 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:20:24.964 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:20:24.985 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:20:25.058 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:20:25.062 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:20:25.367 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:20:25.372 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:20:25.617 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:20:25.632 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:20:25.639 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:20:25.639 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:20:25.653 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:20:25.909 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:20:25.913 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:20:25.918 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:20:25.918 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:20:25.918 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.496 seconds (JVM running for 2.975)
2025-09-30 08:20:25.924 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:20:25.924 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:20:25.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:20:25.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:20:25.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:20:25.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:20:25.925 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:20:25.926 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:20:25.926 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:19:25(String), 2025-09-30 08:20:25(String)
2025-09-30 08:20:25.926 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:20:41.713 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 08:20:41.714 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 08:20:41.714 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 08:20:41.728 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:20:41.728 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:20:41.729 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:20:41.772 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:20:41.772 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:20:41(String)
2025-09-30 08:20:41.778 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:20:41.779 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:20:41.779 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:41.783 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:20:41.783 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:20:41.783 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:41.784 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:20:43.490 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:20:43.491 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:20:43.491 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:20:43.493 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:20:43.494 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:20:43(String)
2025-09-30 08:20:43.562 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:20:43.562 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:20:43.563 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:43.567 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:20:43.568 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:20:43.568 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:43.568 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:20:44.116 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:20:44.116 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:20:44.116 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:20:44.118 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:20:44.118 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:20:44(String)
2025-09-30 08:20:44.127 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:20:44.127 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:20:44.128 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:44.132 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:20:44.132 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:20:44.134 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:44.134 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:20:44.725 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:20:44.725 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:20:44.726 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:20:44.728 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:20:44.728 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:20:44(String)
2025-09-30 08:20:44.734 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:20:44.734 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:20:44.734 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:44.805 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:20:44.806 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:20:44.806 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:44.806 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:20:45.285 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:20:45.285 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:20:45.286 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:20:45.287 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:20:45.287 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:20:45(String)
2025-09-30 08:20:45.296 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:20:45.296 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:20:45.296 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:45.301 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:20:45.301 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:20:45.301 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:20:45.301 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:21:25.916 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:21:25.916 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:21:25.917 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:21:25.917 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:21:25.917 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:21:25.919 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:21:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:21:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:21:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:21:25.923 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:21:25.923 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:20:25(String), 2025-09-30 08:21:25(String)
2025-09-30 08:21:25.924 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:22:25.919 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:22:25.919 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:22:25.920 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:22:25.920 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:22:25.920 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:22:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:22:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:22:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:22:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:22:25.922 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:22:25.922 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:21:25(String), 2025-09-30 08:22:25(String)
2025-09-30 08:23:25.919 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:23:25.920 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:23:25.920 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:23:25.920 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:23:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:23:25.921 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:23:25.922 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:23:25.922 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:23:25.923 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:23:25.924 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:23:25.925 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:22:25(String), 2025-09-30 08:23:25(String)
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:24:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:24:25.929 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:24:25.929 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:24:25.929 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:23:25(String), 2025-09-30 08:24:25(String)
2025-09-30 08:24:49.876 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:24:49.876 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:24:49.876 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:24:49.876 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:24:49.876 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:24:49.876 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:24:49.877 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:24:49.877 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:24:49.878 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:24:49.878 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:24:49.878 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:24:49.878 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:24:49.878 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:24:49.878 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:24:49.878 [http-nio-65535-exec-8] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:25:03.784 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:03.785 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:03.785 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:03.787 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:03.787 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:03(String)
2025-09-30 08:25:03.798 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:03.799 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:03.799 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:03.871 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:03.871 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:03.871 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:03.871 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:04.837 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:04.838 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:04.838 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:04.842 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:04.842 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:04(String)
2025-09-30 08:25:04.854 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:04.854 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:04.854 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:04.861 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:04.862 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:04.862 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:04.863 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:05.662 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:05.663 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:05.663 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:05.665 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:05.666 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:05(String)
2025-09-30 08:25:05.676 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:05.676 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:05.676 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:05.684 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:05.684 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:05.684 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:05.684 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:06.348 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:06.349 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:06.350 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:06.353 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:06.353 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:06(String)
2025-09-30 08:25:06.430 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:06.432 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:06.432 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:06.437 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:06.438 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:06.438 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:06.439 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:07.141 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:07.141 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:07.141 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:07.144 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:07.144 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:07(String)
2025-09-30 08:25:07.155 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:07.155 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:07.156 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:07.158 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:07.158 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:07.163 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:07.163 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:25:25.928 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:25:25.929 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:25:25.929 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:25:25.929 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:25:25.929 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:25:25.929 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:25:25.929 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:25:25.930 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:25:25.930 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:25:25.930 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:24:25(String), 2025-09-30 08:25:25(String)
2025-09-30 08:25:25.933 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:25:25.933 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:25:32.893 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 08:25:32.934 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 08:25:32.934 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 08:25:32.934 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:25:32.935 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 08:25:32.937 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 08:25:35.524 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 12488 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:25:35.526 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:25:35.527 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:25:35.869 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:25:35.907 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 33 ms. Found 2 JPA repository interfaces.
2025-09-30 08:25:36.315 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:25:36.322 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:25:36.323 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:25:36.378 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:25:36.378 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 825 ms
2025-09-30 08:25:36.518 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:25:36.594 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:25:36.622 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:25:36.709 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:25:36.753 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:25:36.774 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:25:36.842 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:25:36.846 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:25:37.150 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:25:37.155 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:25:37.391 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:25:37.409 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:25:37.415 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:25:37.416 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:25:37.430 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:25:37.693 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:25:37.697 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:25:37.703 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:25:37.703 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:25:37.703 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.437 seconds (JVM running for 2.809)
2025-09-30 08:25:37.709 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:25:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:25:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:25:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:25:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:25:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:25:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:25:37.711 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:25:37.711 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:24:37(String), 2025-09-30 08:25:37(String)
2025-09-30 08:25:37.714 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:25:37.869 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:25:40.936 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 08:25:40.936 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 08:25:40.937 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-30 08:25:40.952 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:40.952 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:40.952 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:40.995 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:40.995 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:40(String)
2025-09-30 08:25:41.001 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:41.001 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:41.002 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:41.007 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:41.007 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:41.007 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:41.008 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:41.579 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:41.581 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:41.582 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:41.583 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:41.584 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:41(String)
2025-09-30 08:25:41.592 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:41.592 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:41.593 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:41.598 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:41.598 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:41.598 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:41.598 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:43.010 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:43.010 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:43.011 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:43.012 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:43.012 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:43(String)
2025-09-30 08:25:43.022 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:43.022 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:43.023 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:43.027 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:43.028 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:43.028 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:43.028 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:43.635 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:43.635 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:43.635 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:43.637 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:43.637 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:43(String)
2025-09-30 08:25:43.644 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:43.644 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:43.644 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:43.650 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:43.650 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:43.650 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:43.650 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:25:44.276 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:25:44.276 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:25:44.276 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:25:44.277 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:25:44.277 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:25:44(String)
2025-09-30 08:25:44.286 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:25:44.286 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:25:44.287 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:44.291 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:25:44.291 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:25:44.292 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:25:44.292 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:26:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:26:37.710 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:26:37.711 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:26:37.711 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:26:37.711 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:26:37.712 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:26:37.712 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:26:37.712 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:26:37.713 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:26:37.713 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:26:37.713 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:25:37(String), 2025-09-30 08:26:37(String)
2025-09-30 08:26:37.714 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:27:37.707 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:27:37.708 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:27:37.708 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:27:37.708 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:27:37.708 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:27:37.708 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:27:37.709 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:27:37.709 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:27:37.709 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:27:37.709 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:27:37.709 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:26:37(String), 2025-09-30 08:27:37(String)
2025-09-30 08:27:42.889 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:27:42.890 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:27:42.890 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:27:42.893 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:27:42.893 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:27:42(String)
2025-09-30 08:27:42.899 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:27:42.899 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:27:42.899 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:42.903 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:27:42.904 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:27:42.904 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:42.904 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:27:43.421 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:27:43.421 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:27:43.421 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:27:43.423 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:27:43.423 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:27:43(String)
2025-09-30 08:27:43.430 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:27:43.430 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:27:43.430 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:43.435 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:27:43.435 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:27:43.435 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:43.435 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:27:44.107 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:27:44.108 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:27:44.108 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:27:44.110 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:27:44.111 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:27:44(String)
2025-09-30 08:27:44.116 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:27:44.116 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:27:44.116 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:44.121 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:27:44.121 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:27:44.121 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:44.121 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:27:44.609 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:27:44.610 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:27:44.610 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:27:44.611 [http-nio-65535-exec-10] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:27:44.611 [http-nio-65535-exec-10] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:27:44(String)
2025-09-30 08:27:44.618 [http-nio-65535-exec-10] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:27:44.618 [http-nio-65535-exec-10] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:27:44.618 [http-nio-65535-exec-10] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:44.623 [http-nio-65535-exec-10] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:27:44.623 [http-nio-65535-exec-10] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:27:44.623 [http-nio-65535-exec-10] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:44.624 [http-nio-65535-exec-10] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:27:45.139 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:27:45.139 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:27:45.139 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:27:45.140 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:27:45.140 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:27:45(String)
2025-09-30 08:27:45.172 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:27:45.173 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:27:45.173 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:45.178 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:27:45.178 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:27:45.178 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:27:45.178 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:28:37.704 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:28:37.707 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:28:37.707 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:27:37(String), 2025-09-30 08:28:37(String)
2025-09-30 08:28:37.707 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:28:50.664 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 08:28:50.686 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 08:28:50.686 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 08:28:50.688 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:28:50.688 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 08:28:50.689 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 08:28:52.836 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 22992 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:28:52.837 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:28:52.837 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:28:53.184 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:28:53.224 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 32 ms. Found 2 JPA repository interfaces.
2025-09-30 08:28:53.646 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:28:53.654 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:28:53.654 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:28:53.712 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:28:53.713 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 847 ms
2025-09-30 08:28:53.860 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:28:53.932 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:28:53.960 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:28:54.046 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:28:54.090 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:28:54.112 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:28:54.179 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:28:54.184 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:28:54.492 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:28:54.498 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:28:54.741 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:28:54.757 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:28:54.767 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:28:54.767 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:28:54.781 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:28:55.057 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:28:55.062 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:28:55.067 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:28:55.067 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:28:55.067 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.494 seconds (JVM running for 2.877)
2025-09-30 08:28:55.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:28:55.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:28:55.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:28:55.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:28:55.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:28:55.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:28:55.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:28:55.077 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:28:55.077 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:27:55(String), 2025-09-30 08:28:55(String)
2025-09-30 08:28:55.077 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:29:10.055 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 08:29:10.055 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 08:29:10.056 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-30 08:29:10.070 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:29:10.071 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:29:10.072 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:29:10.114 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:29:10.114 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:29:10(String)
2025-09-30 08:29:10.120 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:29:10.120 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:29:10.120 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:10.125 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:29:10.126 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:29:10.126 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:10.126 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:29:10.556 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:29:10.556 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:29:10.556 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:29:10.558 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:29:10.559 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:29:10(String)
2025-09-30 08:29:10.628 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:29:10.628 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:29:10.628 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:10.633 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:29:10.634 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:29:10.634 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:10.634 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:29:11.052 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:29:11.052 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:29:11.053 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:29:11.054 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:29:11.054 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:29:11(String)
2025-09-30 08:29:11.060 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:29:11.060 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:29:11.061 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:11.129 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:29:11.131 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:29:11.131 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:11.131 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:29:11.531 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:29:11.531 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:29:11.531 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:29:11.533 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:29:11.534 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:29:11(String)
2025-09-30 08:29:11.602 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:29:11.603 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:29:11.603 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:11.607 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:29:11.607 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:29:11.608 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:11.608 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:29:12.009 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:29:12.010 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:29:12.010 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:29:12.011 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:29:12.011 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:29:12(String)
2025-09-30 08:29:12.018 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:29:12.018 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:29:12.018 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:12.022 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:29:12.023 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:29:12.023 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:29:12.023 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:29:55.079 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:29:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:29:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:29:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:29:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:29:55.081 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:29:55.082 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:29:55.082 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:29:55.082 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:29:55.083 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:29:55.083 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:28:55(String), 2025-09-30 08:29:55(String)
2025-09-30 08:29:55.083 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:30:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:30:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:30:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:30:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:30:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:30:55.080 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:30:55.081 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:30:55.081 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:30:55.081 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:30:55.081 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:30:55.081 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:29:55(String), 2025-09-30 08:30:55(String)
2025-09-30 08:31:55.072 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:31:55.072 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:31:55.072 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:31:55.073 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:30:55(String), 2025-09-30 08:31:55(String)
2025-09-30 08:32:03.730 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 08:32:03.743 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 08:32:03.743 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 08:32:03.746 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:32:03.749 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 08:32:03.754 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 08:32:07.640 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 24028 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:32:07.641 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:32:07.642 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:32:08.041 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:32:08.075 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 27 ms. Found 2 JPA repository interfaces.
2025-09-30 08:32:08.483 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:32:08.490 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:32:08.491 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:32:08.552 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:32:08.552 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 880 ms
2025-09-30 08:32:08.687 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:32:08.759 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:32:08.784 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:32:08.873 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:32:08.916 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:32:08.938 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:32:09.009 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:32:09.012 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:32:09.314 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:32:09.320 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:32:09.563 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:32:09.579 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:32:09.586 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:32:09.586 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:32:09.599 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:32:09.856 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:32:09.860 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:32:09.864 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:32:09.864 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:32:09.865 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.501 seconds (JVM running for 3.035)
2025-09-30 08:32:09.870 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:32:09.871 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:32:09.871 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:32:09.871 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:32:09.872 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:32:09.872 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:31:09(String), 2025-09-30 08:32:09(String)
2025-09-30 08:32:09.872 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:32:20.518 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 08:32:20.518 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 08:32:20.519 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-30 08:32:20.533 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:32:20.534 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:32:20.535 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:32:20.578 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:32:20.578 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:32:20(String)
2025-09-30 08:32:20.647 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:32:20.648 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:32:20.648 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:20.655 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:32:20.655 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:32:20.655 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:20.657 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:32:20.962 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:32:20.962 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:32:20.962 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:32:20.963 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:32:20.964 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:32:20(String)
2025-09-30 08:32:20.972 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:32:20.973 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:32:20.973 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:20.977 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:32:20.978 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:32:20.978 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:20.978 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:32:21.396 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:32:21.398 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:32:21.398 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:32:21.399 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:32:21.399 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:32:21(String)
2025-09-30 08:32:21.470 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:32:21.470 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:32:21.471 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:21.477 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:32:21.477 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:32:21.477 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:21.478 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:32:21.804 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:32:21.805 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:32:21.805 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:32:21.807 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:32:21.807 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:32:21(String)
2025-09-30 08:32:21.879 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:32:21.879 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:32:21.880 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:21.886 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:32:21.886 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:32:21.886 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:21.886 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:32:22.179 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:32:22.179 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:32:22.180 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:32:22.181 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:32:22.181 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:32:22(String)
2025-09-30 08:32:22.190 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:32:22.191 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:32:22.191 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:22.195 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:32:22.196 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:32:22.196 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:32:22.196 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:33:09.868 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:33:09.868 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:33:09.868 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:33:09.869 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:33:09.869 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:33:09.869 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:33:09.869 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:33:09.869 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:32:09(String), 2025-09-30 08:33:09(String)
2025-09-30 08:33:09.870 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:34:09.865 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:34:09.865 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:34:09.866 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:34:09.866 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:34:09.866 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:34:09.866 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:34:09.867 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:34:09.867 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:33:09(String), 2025-09-30 08:34:09(String)
2025-09-30 08:35:09.866 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:35:09.866 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:35:09.868 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:35:09.868 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:35:09.868 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:35:09.868 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:35:09.869 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:35:09.869 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:34:09(String), 2025-09-30 08:35:09(String)
2025-09-30 08:36:09.874 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:36:09.874 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:36:09.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:36:09.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:36:09.877 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:36:09.877 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:36:09.880 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:36:09.881 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:35:09(String), 2025-09-30 08:36:09(String)
2025-09-30 08:37:09.863 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:37:09.863 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:37:09.863 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:37:09.864 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:37:09.864 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:37:09.864 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:37:09.864 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:37:09.865 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:36:09(String), 2025-09-30 08:37:09(String)
2025-09-30 08:37:09.865 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:38:03.294 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 08:38:03.329 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 08:38:03.329 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 08:38:03.330 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:38:03.332 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 08:38:03.334 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 08:38:06.854 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 4272 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 08:38:06.856 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 08:38:06.856 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 08:38:07.258 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 08:38:07.291 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 27 ms. Found 2 JPA repository interfaces.
2025-09-30 08:38:07.703 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 08:38:07.710 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 08:38:07.711 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 08:38:07.768 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 08:38:07.768 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 881 ms
2025-09-30 08:38:07.910 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 08:38:07.980 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 08:38:08.006 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 08:38:08.095 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 08:38:08.139 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:38:08.162 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 08:38:08.240 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 08:38:08.245 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 08:38:08.551 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 08:38:08.558 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 08:38:08.801 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 08:38:08.816 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 08:38:08.822 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 08:38:08.823 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 08:38:08.835 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 08:38:09.081 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 08:38:09.086 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 08:38:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:38:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:38:09.091 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.5 seconds (JVM running for 2.993)
2025-09-30 08:38:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:38:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:38:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:38:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:38:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:38:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:38:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:38:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:38:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:37:09(String), 2025-09-30 08:38:09(String)
2025-09-30 08:38:09.100 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:38:44.718 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 08:38:44.719 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 08:38:44.719 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 08:38:44.734 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:38:44.734 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:38:44.735 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:38:44.779 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:38:44.779 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:38:44(String)
2025-09-30 08:38:44.785 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:38:44.785 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:38:44.785 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:44.791 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:38:44.791 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:38:44.791 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:44.792 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:38:45.260 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:38:45.260 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:38:45.260 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:38:45.262 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:38:45.262 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:38:45(String)
2025-09-30 08:38:45.271 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:38:45.271 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:38:45.271 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:45.276 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:38:45.277 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:38:45.277 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:45.277 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:38:45.800 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:38:45.801 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:38:45.801 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:38:45.803 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:38:45.803 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:38:45(String)
2025-09-30 08:38:45.916 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:38:45.917 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:38:45.917 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:45.924 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:38:45.924 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:38:45.924 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:45.925 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:38:46.291 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:38:46.291 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:38:46.292 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:38:46.294 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:38:46.294 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:38:46(String)
2025-09-30 08:38:46.303 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:38:46.304 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:38:46.304 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:46.308 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:38:46.308 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:38:46.308 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:46.309 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:38:46.715 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 08:38:46.716 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 08:38:46.716 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 08:38:46.717 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 08:38:46.717 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 08:38:46(String)
2025-09-30 08:38:46.726 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 08:38:46.726 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 08:38:46.726 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:46.731 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 08:38:46.731 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 08:38:46.731 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 08:38:46.732 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 08:39:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:39:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:39:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:39:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:39:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:39:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:39:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:39:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:39:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:39:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:39:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:38:09(String), 2025-09-30 08:39:09(String)
2025-09-30 08:39:09.100 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 08:40:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:40:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:40:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:40:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:40:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:40:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:40:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:40:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:40:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:40:09.102 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:40:09.102 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:39:09(String), 2025-09-30 08:40:09(String)
2025-09-30 08:41:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:41:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:41:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:41:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:41:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:41:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:41:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:41:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:41:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:41:09.093 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:41:09.094 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:40:09(String), 2025-09-30 08:41:09(String)
2025-09-30 08:42:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:42:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:42:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:42:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:42:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:42:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:42:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:42:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:42:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:42:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:42:09.105 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:41:09(String), 2025-09-30 08:42:09(String)
2025-09-30 08:43:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:43:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:43:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:43:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:43:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:43:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:43:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:43:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:43:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:43:09.094 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:43:09.094 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:42:09(String), 2025-09-30 08:43:09(String)
2025-09-30 08:43:09.096 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:44:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:44:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:44:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:44:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:44:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:44:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:44:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:44:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:44:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:44:09.100 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:44:09.100 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:43:09(String), 2025-09-30 08:44:09(String)
2025-09-30 08:45:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:45:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:45:09.105 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:45:09.105 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:45:09.105 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:45:09.105 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:45:09.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:45:09.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:45:09.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:45:09.107 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:45:09.107 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:44:09(String), 2025-09-30 08:45:09(String)
2025-09-30 08:46:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:46:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:46:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:46:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:46:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:46:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:46:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:46:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:46:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:46:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:46:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:45:09(String), 2025-09-30 08:46:09(String)
2025-09-30 08:47:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:47:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:47:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:47:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:47:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:47:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:47:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:47:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:47:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:47:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:47:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:46:09(String), 2025-09-30 08:47:09(String)
2025-09-30 08:48:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:48:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:48:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:48:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:48:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:48:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:48:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:48:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:48:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:48:09.103 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:48:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:47:09(String), 2025-09-30 08:48:09(String)
2025-09-30 08:48:09.105 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:49:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:49:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:49:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:49:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:48:09(String), 2025-09-30 08:49:09(String)
2025-09-30 08:50:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:50:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:50:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:50:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:50:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:50:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:50:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:50:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:50:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:50:09.105 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:50:09.105 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:49:09(String), 2025-09-30 08:50:09(String)
2025-09-30 08:51:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:51:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:51:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:51:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:51:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:51:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:51:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:51:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:51:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:51:09.103 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:51:09.103 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:50:09(String), 2025-09-30 08:51:09(String)
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:52:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:52:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:52:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:52:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:51:09(String), 2025-09-30 08:52:09(String)
2025-09-30 08:53:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:53:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:53:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:53:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:53:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:53:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:53:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:53:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:53:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:53:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:53:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:52:09(String), 2025-09-30 08:53:09(String)
2025-09-30 08:53:09.097 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:54:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:54:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:54:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:54:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:54:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:54:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:54:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:54:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:54:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:54:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:54:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:53:09(String), 2025-09-30 08:54:09(String)
2025-09-30 08:55:09.089 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:55:09.089 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:55:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:55:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:55:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:55:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:55:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:55:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:55:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:55:09.093 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:55:09.093 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:54:09(String), 2025-09-30 08:55:09(String)
2025-09-30 08:56:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:56:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:56:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:56:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:56:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:56:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:56:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:56:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:56:09.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:56:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:56:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:55:09(String), 2025-09-30 08:56:09(String)
2025-09-30 08:57:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:57:09.090 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:57:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:57:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:57:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:57:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:57:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:57:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:57:09.092 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:57:09.093 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:57:09.094 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:56:09(String), 2025-09-30 08:57:09(String)
2025-09-30 08:58:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:58:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:58:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:58:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:58:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:58:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:58:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:58:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:58:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:58:09.101 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:58:09.101 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:57:09(String), 2025-09-30 08:58:09(String)
2025-09-30 08:58:09.101 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 08:59:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:59:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 08:59:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:59:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:59:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 08:59:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:59:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 08:59:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 08:59:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 08:59:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 08:59:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:58:09(String), 2025-09-30 08:59:09(String)
2025-09-30 09:00:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:00:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:00:09.099 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:00:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:00:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:00:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:00:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:00:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:00:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:00:09.102 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:00:09.102 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 08:59:09(String), 2025-09-30 09:00:09(String)
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:01:09.101 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:00:09(String), 2025-09-30 09:01:09(String)
2025-09-30 09:02:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:02:09.091 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:02:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:02:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:02:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:02:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:02:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:02:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:02:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:02:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:02:09.095 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:01:09(String), 2025-09-30 09:02:09(String)
2025-09-30 09:03:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:03:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:03:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:03:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:03:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:03:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:03:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:03:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:03:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:03:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:03:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:02:09(String), 2025-09-30 09:03:09(String)
2025-09-30 09:03:09.100 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:04:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:04:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:04:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:04:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:04:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:04:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:04:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:04:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:04:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:04:09.102 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:04:09.102 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:03:09(String), 2025-09-30 09:04:09(String)
2025-09-30 09:05:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:05:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:05:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:05:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:05:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:05:09.093 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:05:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:05:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:05:09.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:05:09.096 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:05:09.096 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:04:09(String), 2025-09-30 09:05:09(String)
2025-09-30 09:06:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:06:09.095 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:06:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:06:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:06:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:06:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:06:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:06:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:06:09.097 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:06:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:06:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:05:09(String), 2025-09-30 09:06:09(String)
2025-09-30 09:07:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:07:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:07:09.100 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:07:09.101 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:06:09(String), 2025-09-30 09:07:09(String)
2025-09-30 09:08:09.096 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:08:09.098 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:08:09.099 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:07:09(String), 2025-09-30 09:08:09(String)
2025-09-30 09:08:09.099 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:09:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:09:09.101 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:09:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:09:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:09:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:09:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:09:09.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:09:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:09:09.104 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:09:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:09:09.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:08:09(String), 2025-09-30 09:09:09(String)
2025-09-30 09:09:26.400 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 09:09:26.428 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 09:09:26.428 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 09:09:26.429 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:09:26.436 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 09:09:26.440 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 09:09:34.713 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 26396 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 09:09:34.714 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 09:09:34.715 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 09:09:35.682 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 09:09:35.720 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 32 ms. Found 2 JPA repository interfaces.
2025-09-30 09:09:36.309 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 09:09:36.319 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 09:09:36.319 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 09:09:36.406 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 09:09:36.407 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1664 ms
2025-09-30 09:09:36.663 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 09:09:36.747 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 09:09:36.796 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 09:09:36.927 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 09:09:36.990 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:09:37.018 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 09:09:37.091 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 09:09:37.095 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:09:37.454 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 09:09:37.461 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:09:37.733 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 09:09:37.748 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 09:09:37.755 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 09:09:37.755 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 09:09:37.768 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 09:09:38.052 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 09:09:38.057 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 09:09:38.066 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:09:38.066 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:09:38.066 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 3.629 seconds (JVM running for 4.348)
2025-09-30 09:09:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:09:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:09:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:09:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:09:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:09:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:09:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:09:38.075 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:09:38.075 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:08:38(String), 2025-09-30 09:09:38(String)
2025-09-30 09:09:38.075 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:09:54.045 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 09:09:54.045 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 09:09:54.046 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-30 09:09:54.065 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:09:54.066 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:09:54.068 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:09:54.102 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:09:54.102 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:09:54.103 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:09:54.196 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:09:54.197 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:09:53(String)
2025-09-30 09:09:54.266 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:09:54.267 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:09:54.267 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:54.274 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:09:54.275 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:09:54.276 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:54.277 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:09:54.654 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:09:54.655 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:09:54.655 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:09:54.659 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:09:54.659 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:09:54(String)
2025-09-30 09:09:54.734 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:09:54.736 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:09:54.736 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:54.743 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:09:54.744 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:09:54.744 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:54.745 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:09:55.338 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:09:55.338 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:09:55.339 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:09:55.342 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:09:55.344 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:09:55(String)
2025-09-30 09:09:55.353 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:09:55.354 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:09:55.354 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:55.360 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:09:55.362 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:09:55.362 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:55.363 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:09:55.829 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:09:55.829 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:09:55.829 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:09:55.832 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:09:55.833 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:09:55(String)
2025-09-30 09:09:55.842 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:09:55.843 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:09:55.843 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:55.850 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:09:55.851 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:09:55.851 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:55.851 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:09:56.193 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:09:56.193 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:09:56.194 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:09:56.197 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:09:56.197 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:09:56(String)
2025-09-30 09:09:56.271 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:09:56.271 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:09:56.272 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:56.281 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:09:56.281 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:09:56.282 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:09:56.282 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:10:38.069 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:10:38.069 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:10:38.071 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:10:38.072 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:10:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:10:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:10:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:10:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:10:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:10:38.074 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:10:38.074 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:09:38(String), 2025-09-30 09:10:38(String)
2025-09-30 09:10:38.076 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 09:11:38.072 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:11:38.072 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:11:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:11:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:11:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:11:38.075 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:11:38.075 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:11:38.075 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:11:38.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:11:38.077 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:11:38.077 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:10:38(String), 2025-09-30 09:11:38(String)
2025-09-30 09:12:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:12:38.074 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:12:38.075 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:12:38.075 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:12:38.075 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:12:38.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:12:38.076 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:12:38.077 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:12:38.077 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:12:38.079 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:12:38.079 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:11:38(String), 2025-09-30 09:12:38(String)
2025-09-30 09:13:38.060 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:13:38.061 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:13:38.061 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:13:38.062 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:13:38.062 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:13:38.063 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:13:38.063 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:13:38.063 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:13:38.064 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:13:38.065 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:13:38.065 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:12:38(String), 2025-09-30 09:13:38(String)
2025-09-30 09:14:38.071 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:14:38.071 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:14:38.071 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:14:38.071 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:14:38.071 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:14:38.071 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:14:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:14:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:14:38.073 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:14:38.073 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:14:38.073 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:13:38(String), 2025-09-30 09:14:38(String)
2025-09-30 09:14:38.073 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:15:35.066 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 09:15:35.076 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 09:15:35.078 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 09:15:35.082 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:15:35.083 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 09:15:35.085 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 09:15:38.396 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 25380 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 09:15:38.398 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 09:15:38.398 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 09:15:38.782 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 09:15:38.824 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 30 ms. Found 2 JPA repository interfaces.
2025-09-30 09:15:39.232 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 09:15:39.241 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 09:15:39.241 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 09:15:39.300 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 09:15:39.301 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 875 ms
2025-09-30 09:15:39.444 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 09:15:39.513 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 09:15:39.544 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 09:15:39.634 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 09:15:39.682 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:15:39.703 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 09:15:39.767 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 09:15:39.771 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:15:40.072 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 09:15:40.078 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:15:40.328 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 09:15:40.343 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 09:15:40.350 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 09:15:40.350 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 09:15:40.362 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 09:15:40.618 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 09:15:40.622 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 09:15:40.626 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:15:40.626 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:15:40.626 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.488 seconds (JVM running for 2.949)
2025-09-30 09:15:40.633 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:15:40.634 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:15:40.634 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:15:40.634 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:15:40.634 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:15:40.634 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:15:40.634 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:15:40.635 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:15:40.635 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:14:40(String), 2025-09-30 09:15:40(String)
2025-09-30 09:15:40.635 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:15:42.192 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 09:15:42.192 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 09:15:42.192 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 09:15:42.207 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:15:42.207 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:15:42.208 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:15:42.252 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:15:42.253 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:15:42(String)
2025-09-30 09:15:42.259 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:15:42.259 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:15:42.259 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:42.264 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:15:42.264 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:15:42.264 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:42.266 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:15:42.696 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:15:42.697 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:15:42.697 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:15:42.698 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:15:42.698 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:15:42(String)
2025-09-30 09:15:42.706 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:15:42.706 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:15:42.706 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:42.711 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:15:42.711 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:15:42.711 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:42.711 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:15:43.240 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:15:43.240 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:15:43.241 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:15:43.243 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:15:43.243 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:15:43(String)
2025-09-30 09:15:43.250 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:15:43.250 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:15:43.252 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:43.257 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:15:43.258 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:15:43.258 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:43.258 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:15:43.623 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:15:43.623 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:15:43.623 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:15:43.625 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:15:43.626 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:15:43(String)
2025-09-30 09:15:43.698 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:15:43.699 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:15:43.699 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:43.769 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:15:43.769 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:15:43.769 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:43.770 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:15:44.096 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:15:44.096 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:15:44.096 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:15:44.098 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:15:44.098 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:15:44(String)
2025-09-30 09:15:44.103 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:15:44.103 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:15:44.104 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:44.108 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:15:44.109 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:15:44.109 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:15:44.109 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:16:40.635 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:16:40.636 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:16:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:16:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:16:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:16:40.640 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:16:40.642 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:16:40.642 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:16:40.643 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:16:40.644 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:16:40.644 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:15:40(String), 2025-09-30 09:16:40(String)
2025-09-30 09:16:40.648 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 09:17:40.636 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:17:40.636 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:17:40.636 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:17:40.637 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:16:40(String), 2025-09-30 09:17:40(String)
2025-09-30 09:18:40.627 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:18:40.628 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:18:40.628 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:18:40.628 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:18:40.630 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:18:40.630 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:18:40.630 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:18:40.630 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:18:40.630 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:18:40.630 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:18:40.630 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:17:40(String), 2025-09-30 09:18:40(String)
2025-09-30 09:19:40.635 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:19:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:19:40.637 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:19:40.638 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:19:40.638 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:19:40.638 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:19:40.639 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:19:40.639 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:19:40.639 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:19:40.640 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:19:40.640 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:18:40(String), 2025-09-30 09:19:40(String)
2025-09-30 09:20:40.629 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:20:40.630 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:20:40.630 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:20:40.631 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:20:40.631 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:20:40.631 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:20:40.632 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:20:40.632 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:20:40.633 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:20:40.633 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:20:40.634 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:19:40(String), 2025-09-30 09:20:40(String)
2025-09-30 09:20:40.635 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:20:49.513 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 09:20:49.543 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 09:20:49.543 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 09:20:49.544 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:20:49.551 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 09:20:49.555 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 09:20:52.349 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 27792 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 09:20:52.351 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 09:20:52.352 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 09:20:52.700 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 09:20:52.739 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 34 ms. Found 2 JPA repository interfaces.
2025-09-30 09:20:53.154 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 09:20:53.160 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 09:20:53.160 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 09:20:53.217 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 09:20:53.217 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 835 ms
2025-09-30 09:20:53.357 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 09:20:53.426 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 09:20:53.454 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 09:20:53.542 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 09:20:53.584 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:20:53.605 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 09:20:53.672 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 09:20:53.675 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:20:53.967 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 09:20:53.973 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:20:54.206 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 09:20:54.225 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 09:20:54.231 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 09:20:54.231 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 09:20:54.245 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 09:20:54.495 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 09:20:54.499 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 09:20:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:20:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:20:54.504 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.418 seconds (JVM running for 2.863)
2025-09-30 09:20:54.510 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:20:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:20:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:20:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:20:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:20:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:20:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:20:54.512 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:20:54.512 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:19:54(String), 2025-09-30 09:20:54(String)
2025-09-30 09:20:54.513 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:20:59.608 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 09:20:59.608 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 09:20:59.609 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 09:20:59.623 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:20:59.623 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:20:59.624 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:20:59.667 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:20:59.667 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:20:59(String)
2025-09-30 09:20:59.673 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:20:59.674 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:20:59.674 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:20:59.679 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:20:59.679 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:20:59.679 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:20:59.680 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:21:00.052 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:21:00.052 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:21:00.053 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:21:00.054 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:21:00.055 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:21:00(String)
2025-09-30 09:21:00.065 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:21:00.065 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:21:00.065 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:00.071 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:21:00.071 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:21:00.072 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:00.072 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:21:00.565 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:21:00.565 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:21:00.566 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:21:00.567 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:21:00.567 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:21:00(String)
2025-09-30 09:21:00.588 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:21:00.589 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:21:00.589 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:00.594 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:21:00.596 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:21:00.596 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:00.596 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:21:01.027 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:21:01.028 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:21:01.028 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:21:01.030 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:21:01.030 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:21:01(String)
2025-09-30 09:21:01.040 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:21:01.040 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:21:01.040 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:01.048 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:21:01.048 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:21:01.048 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:01.049 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:21:01.572 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:21:01.572 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:21:01.572 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:21:01.573 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:21:01.574 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:21:01(String)
2025-09-30 09:21:01.579 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:21:01.580 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:21:01.580 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:01.586 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:21:01.586 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:21:01.586 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:21:01.586 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:21:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:21:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:21:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:21:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:21:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:21:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:21:54.510 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:21:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:21:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:21:54.512 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:21:54.512 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:20:54(String), 2025-09-30 09:21:54(String)
2025-09-30 09:21:54.513 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 09:22:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:22:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:22:54.509 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:22:54.509 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:22:54.510 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:22:54.510 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:22:54.510 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:22:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:22:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:22:54.513 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:22:54.514 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:21:54(String), 2025-09-30 09:22:54(String)
2025-09-30 09:23:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:23:54.504 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:23:54.504 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:23:54.505 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:23:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:23:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:23:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:23:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:23:54.510 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:23:54.511 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:23:54.512 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:22:54(String), 2025-09-30 09:23:54(String)
2025-09-30 09:24:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:24:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:24:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:24:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:24:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:24:54.514 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:24:54.514 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:24:54.514 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:24:54.514 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:24:54.515 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:24:54.516 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:23:54(String), 2025-09-30 09:24:54(String)
2025-09-30 09:25:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:25:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:25:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:25:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:25:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:25:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:25:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:25:54.509 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:25:54.509 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:25:54.509 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:25:54.509 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:24:54(String), 2025-09-30 09:25:54(String)
2025-09-30 09:25:54.509 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:26:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:26:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:26:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:26:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:26:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:26:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:26:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:26:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:26:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:26:54.507 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:26:54.508 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:25:54(String), 2025-09-30 09:26:54(String)
2025-09-30 09:27:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:27:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:27:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:27:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:27:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:27:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:27:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:27:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:27:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:27:54.514 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:27:54.514 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:26:54(String), 2025-09-30 09:27:54(String)
2025-09-30 09:28:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:28:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:28:54.506 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:28:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:28:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:28:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:28:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:28:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:28:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:28:54.508 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:28:54.508 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:27:54(String), 2025-09-30 09:28:54(String)
2025-09-30 09:29:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:29:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:29:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:29:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:29:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:29:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:29:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:29:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:29:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:29:54.505 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:29:54.505 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:28:54(String), 2025-09-30 09:29:54(String)
2025-09-30 09:30:54.505 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:30:54.505 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:30:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:30:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:30:54.507 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:30:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:30:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:30:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:30:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:30:54.509 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:30:54.509 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:29:54(String), 2025-09-30 09:30:54(String)
2025-09-30 09:30:54.509 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:31:54.514 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:31:54.514 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:31:54.514 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:31:54.516 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:31:54.516 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:31:54.516 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:31:54.516 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:31:54.516 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:31:54.516 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:31:54.520 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:31:54.520 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:30:54(String), 2025-09-30 09:31:54(String)
2025-09-30 09:32:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:32:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:32:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:32:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:32:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:32:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:32:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:32:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:32:54.504 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:32:54.504 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:32:54.505 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:31:54(String), 2025-09-30 09:32:54(String)
2025-09-30 09:33:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:33:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:33:54.502 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:33:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:33:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:33:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:33:54.503 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:33:54.504 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:33:54.504 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:33:54.504 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:33:54.504 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:32:54(String), 2025-09-30 09:33:54(String)
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:34:54.511 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:33:54(String), 2025-09-30 09:34:54(String)
2025-09-30 09:35:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:35:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:35:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:35:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:35:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:35:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:35:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:35:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:35:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:35:54.514 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:35:54.514 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:34:54(String), 2025-09-30 09:35:54(String)
2025-09-30 09:35:54.514 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:36:54.508 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:36:54.510 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:36:54.510 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:35:54(String), 2025-09-30 09:36:54(String)
2025-09-30 09:37:54.517 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:37:54.517 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:37:54.518 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:37:54.518 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:37:54.518 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:37:54.518 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:37:54.518 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:37:54.518 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:37:54.519 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:37:54.520 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:37:54.520 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:36:54(String), 2025-09-30 09:37:54(String)
2025-09-30 09:38:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:38:54.511 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:38:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:38:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:38:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:38:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:38:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:38:54.512 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:38:54.513 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:38:54.513 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:38:54.514 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:37:54(String), 2025-09-30 09:38:54(String)
2025-09-30 09:39:37.651 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:39:37.651 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:39:37.652 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:39:37.652 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:39:37.652 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:39:37.652 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:39:37.652 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:39:37.652 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:39:37.652 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:39:37.653 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:39:37.653 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:38:37(String), 2025-09-30 09:39:37(String)
2025-09-30 09:40:30.217 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 09:40:30.259 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 09:40:30.259 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 09:40:30.260 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:40:30.262 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 09:40:30.265 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 09:40:39.706 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 27520 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 09:40:39.708 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 09:40:39.708 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 09:40:40.288 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 09:40:40.324 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 30 ms. Found 2 JPA repository interfaces.
2025-09-30 09:40:40.787 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 09:40:40.797 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 09:40:40.797 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 09:40:40.872 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 09:40:40.873 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1135 ms
2025-09-30 09:40:41.062 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 09:40:41.148 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 09:40:41.191 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 09:40:41.314 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 09:40:41.363 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:40:41.389 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 09:40:41.461 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 09:40:41.465 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 09:40:41.838 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 09:40:41.845 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:40:42.091 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 09:40:42.105 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 09:40:42.112 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 09:40:42.112 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 09:40:42.123 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 09:40:42.390 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 09:40:42.394 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 09:40:42.398 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:40:42.398 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:40:42.399 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.971 seconds (JVM running for 3.767)
2025-09-30 09:40:42.405 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:40:42.406 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:40:42.406 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:40:42.406 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:40:42.407 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:40:42.407 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:40:42.407 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:40:42.408 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:40:42.408 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:39:42(String), 2025-09-30 09:40:42(String)
2025-09-30 09:40:42.408 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:40:44.425 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 09:40:44.426 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 09:40:44.426 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 09:40:44.435 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:40:44.435 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:40:44.437 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:40:44.454 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:40:44.454 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:40:44.455 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:40:44.502 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:40:44.503 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:40:44(String)
2025-09-30 09:40:44.508 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:40:44.508 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:40:44.508 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:44.513 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:40:44.513 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:40:44.513 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:44.514 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:40:45.316 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:40:45.317 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:40:45.317 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:40:45.318 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:40:45.318 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:40:45(String)
2025-09-30 09:40:45.327 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:40:45.328 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:40:45.328 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:45.334 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:40:45.334 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:40:45.334 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:45.335 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:40:45.941 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:40:45.942 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:40:45.942 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:40:45.943 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:40:45.944 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:40:45(String)
2025-09-30 09:40:45.950 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:40:45.950 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:40:45.950 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:45.955 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:40:45.955 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:40:45.955 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:45.955 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:40:46.451 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:40:46.451 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:40:46.451 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:40:46.453 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:40:46.453 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:40:46(String)
2025-09-30 09:40:46.462 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:40:46.462 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:40:46.462 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:46.467 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:40:46.467 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:40:46.467 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:46.467 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:40:47.173 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 09:40:47.174 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 09:40:47.174 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 09:40:47.175 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 09:40:47.175 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 09:40:47(String)
2025-09-30 09:40:47.181 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 09:40:47.182 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 09:40:47.182 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:47.187 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 09:40:47.188 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 09:40:47.188 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 09:40:47.188 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 09:41:42.405 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:41:42.405 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:41:42.407 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:41:42.409 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:41:42.409 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:41:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:41:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:41:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:41:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:41:42.411 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:41:42.411 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:40:42(String), 2025-09-30 09:41:42(String)
2025-09-30 09:41:42.416 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 09:42:42.407 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:42:42.408 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:42:42.409 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:42:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:42:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:42:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:42:42.412 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:42:42.412 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:42:42.413 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:42:42.414 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:42:42.415 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:41:42(String), 2025-09-30 09:42:42(String)
2025-09-30 09:43:42.410 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:43:42.412 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:43:42.412 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:43:42.412 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:43:42.412 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:43:42.412 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:43:42.413 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:43:42.413 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:43:42.413 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:43:42.414 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:43:42.414 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:42:42(String), 2025-09-30 09:43:42(String)
2025-09-30 09:44:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:44:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:44:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:44:42.404 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:44:42.404 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:44:42.404 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:44:42.404 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:44:42.404 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:44:42.404 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:44:42.405 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:44:42.406 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:43:42(String), 2025-09-30 09:44:42(String)
2025-09-30 09:45:42.401 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:45:42.401 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 09:45:42.401 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:45:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:45:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 09:45:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:45:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 09:45:42.402 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 09:45:42.403 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 09:45:42.403 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 09:45:42.403 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 09:44:42(String), 2025-09-30 09:45:42(String)
2025-09-30 09:45:42.404 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 09:46:16.378 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 09:46:16.413 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 09:46:16.413 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 09:46:16.415 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 09:46:16.417 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 09:46:16.420 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 10:28:55.629 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 2264 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 10:28:55.630 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 10:28:55.632 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 10:28:57.215 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 10:28:57.260 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 37 ms. Found 2 JPA repository interfaces.
2025-09-30 10:28:57.784 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 10:28:57.794 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 10:28:57.795 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 10:28:57.871 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 10:28:57.871 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2207 ms
2025-09-30 10:28:58.148 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 10:28:58.325 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 10:28:58.401 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 10:28:58.540 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 10:28:58.610 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:28:58.642 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 10:28:58.721 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 10:28:58.725 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:28:59.180 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 10:28:59.186 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:28:59.466 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 10:28:59.483 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 10:28:59.489 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 10:28:59.489 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 10:28:59.503 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 10:28:59.857 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 10:28:59.861 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 10:28:59.865 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:28:59.865 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:28:59.866 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 4.68 seconds (JVM running for 5.398)
2025-09-30 10:28:59.873 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:28:59.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:28:59.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:28:59.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:28:59.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:28:59.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:28:59.875 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:28:59.876 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:28:59.876 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:27:59(String), 2025-09-30 10:28:59(String)
2025-09-30 10:28:59.877 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 10:28:59.897 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 10:28:59.898 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 10:28:59.898 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-30 10:28:59.906 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:28:59.906 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:28:59.908 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:28:59.923 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:28:59.923 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:28:59.924 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:28:59.967 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:28:59.968 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:28:58(String)
2025-09-30 10:29:00.037 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:29:00.038 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:29:00.039 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:00.045 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:29:00.045 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:29:00.046 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:00.047 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:29:04.383 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:29:04.383 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:29:04.384 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:29:04.385 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:29:04.385 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:29:04(String)
2025-09-30 10:29:04.394 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:29:04.394 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:29:04.394 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:04.400 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:29:04.400 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:29:04.401 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:04.401 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:29:04.944 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:29:04.944 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:29:04.944 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:29:04.945 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:29:04.946 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:29:04(String)
2025-09-30 10:29:04.953 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:29:04.953 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:29:04.953 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:04.958 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:29:04.958 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:29:04.959 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:04.959 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:29:05.449 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:29:05.449 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:29:05.450 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:29:05.451 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:29:05.451 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:29:05(String)
2025-09-30 10:29:05.525 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:29:05.525 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:29:05.525 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:05.531 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:29:05.531 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:29:05.532 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:05.532 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:29:05.922 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:29:05.922 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:29:05.922 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:29:05.924 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:29:05.924 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:29:05(String)
2025-09-30 10:29:05.931 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:29:05.932 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:29:05.932 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:05.937 [http-nio-65535-exec-6] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:29:05.937 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:29:05.939 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:05.939 [http-nio-65535-exec-6] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:29:06.327 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:29:06.327 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:29:06.328 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:29:06.332 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:29:06.332 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:29:06(String)
2025-09-30 10:29:06.338 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:29:06.338 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:29:06.338 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:06.345 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:29:06.346 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:29:06.346 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:06.346 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:29:06.818 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:29:06.818 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:29:06.819 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:29:06.820 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:29:06.820 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:29:06(String)
2025-09-30 10:29:06.826 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:29:06.826 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:29:06.827 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:06.896 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:29:06.897 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:29:06.897 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:29:06.897 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:29:59.870 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:29:59.871 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:29:59.872 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:29:59.872 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:29:59.872 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:29:59.872 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:29:59.873 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:29:59.873 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:29:59.873 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:29:59.875 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:29:59.875 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:28:59(String), 2025-09-30 10:29:59(String)
2025-09-30 10:29:59.877 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 6
2025-09-30 10:30:59.876 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:30:59.878 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:30:59.878 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:30:59.879 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:30:59.879 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:30:59.879 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:30:59.879 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:30:59.879 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:30:59.881 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:30:59.881 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:30:59.881 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:29:59(String), 2025-09-30 10:30:59(String)
2025-09-30 10:31:04.811 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 10:31:04.845 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 10:31:04.846 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 10:31:04.846 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:31:04.847 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 10:31:04.849 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 10:31:06.741 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 3696 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 10:31:06.742 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 10:31:06.743 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 10:31:07.110 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 10:31:07.149 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 32 ms. Found 2 JPA repository interfaces.
2025-09-30 10:31:07.587 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 10:31:07.595 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 10:31:07.595 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 10:31:07.661 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 10:31:07.661 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 890 ms
2025-09-30 10:31:07.802 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 10:31:07.872 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 10:31:07.900 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 10:31:07.988 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 10:31:08.036 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:31:08.058 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 10:31:08.131 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 10:31:08.136 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:31:08.442 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 10:31:08.447 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:31:08.699 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 10:31:08.714 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 10:31:08.721 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 10:31:08.721 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 10:31:08.734 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 10:31:08.993 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 10:31:08.998 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 10:31:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:31:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:31:09.002 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.531 seconds (JVM running for 3.083)
2025-09-30 10:31:09.009 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:31:09.009 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:31:09.009 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:31:09.010 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:31:09.010 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:31:09.010 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:31:09.010 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:31:09.011 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:31:09.011 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:30:09(String), 2025-09-30 10:31:09(String)
2025-09-30 10:31:09.011 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 10:31:50.684 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 10:31:50.684 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 10:31:50.685 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-30 10:31:50.712 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:31:50.713 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:31:50.714 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:31:50.801 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:31:50.801 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:31:50(String)
2025-09-30 10:31:50.862 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:31:50.863 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:31:50.863 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:50.869 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:31:50.870 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:31:50.871 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:50.874 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:31:51.281 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:31:51.283 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:31:51.284 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:31:51.287 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:31:51.287 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:31:51(String)
2025-09-30 10:31:51.294 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:31:51.294 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:31:51.294 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:51.303 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:31:51.304 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:31:51.304 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:51.305 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:31:51.937 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:31:51.937 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:31:51.938 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:31:51.941 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:31:51.941 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:31:51(String)
2025-09-30 10:31:51.952 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:31:51.952 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:31:51.954 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:51.961 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:31:51.962 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:31:51.962 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:51.963 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:31:52.424 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:31:52.425 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:31:52.425 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:31:52.429 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:31:52.429 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:31:52(String)
2025-09-30 10:31:52.439 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:31:52.440 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:31:52.440 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:52.512 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:31:52.513 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:31:52.514 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:52.515 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:31:52.841 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:31:52.841 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:31:52.842 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:31:52.846 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:31:52.846 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:31:52(String)
2025-09-30 10:31:52.856 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:31:52.857 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:31:52.857 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:52.864 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:31:52.864 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:31:52.864 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:31:52.864 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:32:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:32:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:32:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:32:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:32:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:32:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:32:09.016 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:32:09.016 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:32:09.016 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:32:09.016 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:32:09.017 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:31:09(String), 2025-09-30 10:32:09(String)
2025-09-30 10:32:09.017 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 10:33:09.012 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:33:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:33:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:33:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:33:09.016 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:33:09.016 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:33:09.017 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:33:09.017 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:33:09.017 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:33:09.018 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:33:09.018 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:32:09(String), 2025-09-30 10:33:09(String)
2025-09-30 10:34:09.010 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:34:09.011 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:34:09.012 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:34:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:34:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:34:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:34:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:34:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:34:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:34:09.017 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:34:09.017 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:33:09(String), 2025-09-30 10:34:09(String)
2025-09-30 10:35:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:35:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:35:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:35:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:35:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:35:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:35:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:35:09.015 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:35:09.017 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:35:09.018 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:35:09.018 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:34:09(String), 2025-09-30 10:35:09(String)
2025-09-30 10:36:09.000 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:36:09.000 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:36:09.000 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:36:09.000 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:36:09.000 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:36:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:36:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:36:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:36:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:36:09.003 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:36:09.003 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:35:09(String), 2025-09-30 10:36:09(String)
2025-09-30 10:36:09.003 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 10:37:09.000 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:37:09.001 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:37:09.003 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:37:09.003 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:36:09(String), 2025-09-30 10:37:09(String)
2025-09-30 10:38:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:38:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:38:09.013 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:38:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:38:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:38:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:38:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:38:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:38:09.014 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:38:09.015 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:38:09.015 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:37:09(String), 2025-09-30 10:38:09(String)
2025-09-30 10:39:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:39:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:39:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:39:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:39:09.002 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:39:09.003 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:39:09.003 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:39:09.003 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:39:09.003 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:39:09.003 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:39:09.003 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:38:09(String), 2025-09-30 10:39:09(String)
2025-09-30 10:39:26.246 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 10:39:26.272 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 10:39:26.273 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 10:39:26.274 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:39:26.275 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 10:39:26.277 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 10:39:30.098 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 8312 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 10:39:30.100 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 10:39:30.100 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 10:39:30.561 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 10:39:30.613 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 44 ms. Found 2 JPA repository interfaces.
2025-09-30 10:39:31.054 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 10:39:31.067 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 10:39:31.067 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 10:39:31.125 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 10:39:31.125 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 987 ms
2025-09-30 10:39:31.273 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 10:39:31.346 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 10:39:31.374 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 10:39:31.476 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 10:39:31.525 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:39:31.548 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 10:39:31.625 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 10:39:31.630 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:39:31.969 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 10:39:31.975 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:39:32.222 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 10:39:32.237 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 10:39:32.243 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 10:39:32.244 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 10:39:32.256 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 10:39:32.530 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 10:39:32.534 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 10:39:32.539 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:39:32.539 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:39:32.539 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.757 seconds (JVM running for 3.226)
2025-09-30 10:39:32.547 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:39:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:39:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:39:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:39:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:39:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:39:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:39:32.549 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:39:32.549 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:38:32(String), 2025-09-30 10:39:32(String)
2025-09-30 10:39:32.550 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 10:40:22.713 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 10:40:22.713 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 10:40:22.714 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-30 10:40:22.745 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:40:22.746 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:40:22.748 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:40:22.839 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:40:22.840 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:40:22(String)
2025-09-30 10:40:22.847 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:40:22.848 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:40:22.848 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:22.854 [http-nio-65535-exec-1] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:40:22.855 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:40:22.855 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:22.856 [http-nio-65535-exec-1] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:40:23.280 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:40:23.281 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:40:23.281 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:40:23.284 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:40:23.284 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:40:23(String)
2025-09-30 10:40:23.291 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:40:23.292 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:40:23.292 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:23.362 [http-nio-65535-exec-2] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:40:23.362 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:40:23.363 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:23.364 [http-nio-65535-exec-2] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:40:23.784 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:40:23.784 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:40:23.786 [http-nio-65535-exec-4] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:40:23.789 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:40:23.789 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:40:23(String)
2025-09-30 10:40:23.804 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:40:23.805 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:40:23.806 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:23.811 [http-nio-65535-exec-4] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:40:23.813 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:40:23.813 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:23.814 [http-nio-65535-exec-4] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:40:24.221 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:40:24.221 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:40:24.222 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:40:24.227 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:40:24.228 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:40:24(String)
2025-09-30 10:40:24.301 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:40:24.301 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:40:24.302 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:24.309 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:40:24.310 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:40:24.310 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:24.311 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:40:24.633 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:40:24.633 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:40:24.634 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:40:24.637 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:40:24.637 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:40:24(String)
2025-09-30 10:40:24.644 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:40:24.645 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:40:24.645 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:24.652 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:40:24.652 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:40:24.653 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:40:24.653 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:40:32.547 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:40:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:40:32.548 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:40:32.549 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:40:32.549 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:40:32.551 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:40:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:40:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:40:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:40:32.553 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:40:32.553 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:39:32(String), 2025-09-30 10:40:32(String)
2025-09-30 10:40:32.553 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 10:41:32.550 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:41:32.551 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:41:32.551 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:41:32.551 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:41:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:41:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:41:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:41:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:41:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:41:32.552 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:41:32.553 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:40:32(String), 2025-09-30 10:41:32(String)
2025-09-30 10:42:22.499 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:42:22.499 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:42:22.499 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:42:22.500 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:42:22.500 [http-nio-65535-exec-10] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:42:22.500 [http-nio-65535-exec-6] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:42:22.505 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:22.505 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:42:22.506 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:22.506 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:22.506 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:42:22.507 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:22.507 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:22.508 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:42:22.508 [http-nio-65535-exec-10] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:29.434 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:42:29.434 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:42:29.434 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:42:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:32.552 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:42:32.553 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:32.553 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:32.553 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:42:32.553 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:32.553 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:32.553 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:42:32.554 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:32.554 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:42:32.554 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:41:32(String), 2025-09-30 10:42:32(String)
2025-09-30 10:42:34.868 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 10:42:34.908 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 10:42:34.908 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 10:42:34.911 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:42:34.915 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 10:42:34.918 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-09-30 10:42:37.811 [main] INFO  n.thekingofduck.loki.LokiApplication - Starting LokiApplication using Java 17.0.15 on DESKTOP-GEBHMCS with PID 28332 (D:\CUCDC\Loki\target\classes started by YuKi in D:\CUCDC\Loki)
2025-09-30 10:42:37.812 [main] DEBUG n.thekingofduck.loki.LokiApplication - Running with Spring Boot v2.7.18, Spring v5.3.31
2025-09-30 10:42:37.813 [main] INFO  n.thekingofduck.loki.LokiApplication - No active profile set, falling back to 1 default profile: "default"
2025-09-30 10:42:38.198 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-09-30 10:42:38.235 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 30 ms. Found 2 JPA repository interfaces.
2025-09-30 10:42:38.668 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http) 8090 (http) 65535 (http)
2025-09-30 10:42:38.678 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-09-30 10:42:38.679 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.83]
2025-09-30 10:42:38.737 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-30 10:42:38.737 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 894 ms
2025-09-30 10:42:38.884 [main] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter is init.... 
2025-09-30 10:42:38.956 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-09-30 10:42:38.985 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 5.6.15.Final
2025-09-30 10:42:39.077 [main] INFO  o.h.annotations.common.Version - HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2025-09-30 10:42:39.122 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:42:39.146 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-09-30 10:42:39.215 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-09-30 10:42:39.220 [main] INFO  org.hibernate.dialect.Dialect - HHH000400: Using dialect: org.hibernate.dialect.SQLiteDialect
2025-09-30 10:42:39.529 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-09-30 10:42:39.536 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:42:39.783 [main] INFO  n.t.loki.service.CacheService - 缓存服务已启动，定时清理任务已设置
2025-09-30 10:42:39.798 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS sshserver (id INTEGER PRIMARY KEY AUTOINCREMENT, host TEXT NOT NULL, port INTEGER NOT NULL, username TEXT NOT NULL, password TEXT NOT NULL, remark TEXT, createTime TEXT)
2025-09-30 10:42:39.805 [main] DEBUG n.t.l.m.SshServerMapper.createTable - ==> Parameters: 
2025-09-30 10:42:39.805 [main] DEBUG n.t.l.m.SshServerMapper.createTable - <==    Updates: 0
2025-09-30 10:42:39.820 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-09-30 10:42:40.086 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) 8090 (http) 65535 (http) with context path ''
2025-09-30 10:42:40.091 [main] INFO  o.s.s.a.ScheduledAnnotationBeanPostProcessor - No TaskScheduler/ScheduledExecutorService bean found for scheduled processing
2025-09-30 10:42:40.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:40.094 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:42:40.096 [main] INFO  n.thekingofduck.loki.LokiApplication - Started LokiApplication in 2.635 seconds (JVM running for 3.137)
2025-09-30 10:42:40.102 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:40.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:40.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:42:40.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:40.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:40.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:42:40.103 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:40.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:42:40.104 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:41:40(String), 2025-09-30 10:42:40(String)
2025-09-30 10:42:40.104 [pool-2-thread-1] DEBUG n.t.l.service.SshConnectionManager - 开始清理过期SSH连接...
2025-09-30 10:42:47.441 [http-nio-65535-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-30 10:42:47.441 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-30 10:42:47.442 [http-nio-65535-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-09-30 10:42:47.451 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:42:47.451 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:42:47.451 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:42:47.451 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:42:47.452 [http-nio-65535-exec-1] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:42:47.452 [http-nio-65535-exec-2] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:42:47.458 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:47.458 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:42:47.458 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:47.459 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:47.459 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:42:47.459 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:42:47.459 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:42:47.459 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:42:47.459 [http-nio-65535-exec-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:43:02.186 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:43:02.186 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:43:02.188 [http-nio-65535-exec-3] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:43:02.280 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:43:02.282 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:43:02(String)
2025-09-30 10:43:02.291 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:43:02.298 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:43:02.298 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:02.307 [http-nio-65535-exec-3] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:43:02.308 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:43:02.308 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:02.309 [http-nio-65535-exec-3] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:43:02.832 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:43:02.833 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:43:02.834 [http-nio-65535-exec-5] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:43:02.837 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:43:02.838 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:43:02(String)
2025-09-30 10:43:02.847 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:43:02.848 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:43:02.849 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:02.856 [http-nio-65535-exec-5] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:43:02.857 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:43:02.857 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:02.858 [http-nio-65535-exec-5] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:43:03.382 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:43:03.382 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:43:03.383 [http-nio-65535-exec-7] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:43:03.387 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:43:03.388 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:43:03(String)
2025-09-30 10:43:03.396 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:43:03.397 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:43:03.397 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:03.535 [http-nio-65535-exec-7] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:43:03.535 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:43:03.535 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:03.536 [http-nio-65535-exec-7] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:43:03.841 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:43:03.843 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:43:03.848 [http-nio-65535-exec-8] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:43:03.853 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:43:03.854 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:43:03(String)
2025-09-30 10:43:03.866 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:43:03.866 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:43:03.867 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:03.873 [http-nio-65535-exec-8] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:43:03.874 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:43:03.876 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:03.876 [http-nio-65535-exec-8] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:43:04.270 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==>  Preparing: SELECT ip, isBan FROM httplog WHERE ip = ? ORDER BY id DESC LIMIT 1
2025-09-30 10:43:04.270 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - ==> Parameters: 127.0.0.1(String)
2025-09-30 10:43:04.270 [http-nio-65535-exec-9] DEBUG n.t.l.m.IpBanMapper.findByIpAddress - <==      Total: 1
2025-09-30 10:43:04.272 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==>  Preparing: INSERT INTO `main`.`httplog`(`ip`,`method`,`path`,`parameter`,`headers`,`body`,`time`) VALUES (?,?,?,?,?,?,?)
2025-09-30 10:43:04.272 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - ==> Parameters: 127.0.0.1(String), POST(String), /(String), (String), {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","Content-Type":"application/json","Accept":"application/json"}(String), {"username":"admin' or 1=1--+","password":"123","canvasId":"ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b"}(String), 2025-09-30 10:43:04(String)
2025-09-30 10:43:04.277 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.addHttpLog - <==    Updates: 1
2025-09-30 10:43:04.277 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==>  Preparing: UPDATE `main`.`httplog` SET `canvasId` = ? WHERE id = (SELECT MAX(id) FROM `main`.`httplog`)
2025-09-30 10:43:04.277 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:04.283 [http-nio-65535-exec-9] DEBUG n.t.l.m.HttpLogMapper.updateCanvasId - <==    Updates: 1
2025-09-30 10:43:04.283 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - ==>  Preparing: select count(*) from canvas where canvasId = ?
2025-09-30 10:43:04.283 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - ==> Parameters: ea91df76009b77a90215e474c0932aa74ee1615502f447dcc66c4d23261af10b(String)
2025-09-30 10:43:04.283 [http-nio-65535-exec-9] DEBUG n.t.l.m.H.getCanvasIdCount - <==      Total: 1
2025-09-30 10:43:40.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:43:40.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: timeWindowMinutes(String)
2025-09-30 10:43:40.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:43:40.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:43:40.106 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: attacks_amount(String)
2025-09-30 10:43:40.107 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:43:40.107 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==>  Preparing: SELECT setting_value FROM security_setting WHERE setting_key = ?
2025-09-30 10:43:40.107 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - ==> Parameters: phone(String)
2025-09-30 10:43:40.107 [pool-2-thread-1] DEBUG n.t.l.m.S.findValueByKey - <==      Total: 1
2025-09-30 10:43:40.107 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==>  Preparing: SELECT * FROM httplog WHERE datetime(time) BETWEEN datetime(?) AND datetime(?)
2025-09-30 10:43:40.107 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - ==> Parameters: 2025-09-30 10:42:40(String), 2025-09-30 10:43:40(String)
2025-09-30 10:43:40.109 [pool-2-thread-1] DEBUG n.t.l.m.H.findLogsBetweenDates - <==      Total: 5
2025-09-30 10:44:33.954 [SpringApplicationShutdownHook] INFO  n.thekingofduck.loki.core.LokiFilter - Loki Filter was destroyed....
2025-09-30 10:44:33.990 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - 正在关闭SSH连接管理器，清理所有连接...
2025-09-30 10:44:33.990 [SpringApplicationShutdownHook] INFO  n.t.l.service.SshConnectionManager - SSH连接管理器已关闭
2025-09-30 10:44:33.992 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-09-30 10:44:33.995 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-09-30 10:44:33.998 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
